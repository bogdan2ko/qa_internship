version: "3.9"

services:
  chrome:
    image: selenium/standalone-chrome:latest
    shm_size: 2gb
    ports:
      - "4444:4444"

    # üîπ –ø—Ä–æ–≤–µ—Ä—è–µ–º /status —Ä–∞–∑ –≤ 3‚ÄØ—Å, 10¬†–ø–æ–ø—ã—Ç–æ–∫
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:4444/status"]
      interval: 3s
      timeout: 2s
      retries: 10

  tests:
    build: .
    depends_on:
      chrome:
        condition: service_healthy    # ‚Üê –∂–¥–∞—Ç—å, –ø–æ–∫–∞ healthcheck –∑–µ–ª—ë–Ω—ã–π
    environment:
      - SELENIUM_HOST=chrome
      - SELENIUM_PORT=4444
      - ATS_USER=${ATS_USER}
      - ATS_PASS=${ATS_PASS}
